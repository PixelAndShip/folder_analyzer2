<!doctype html>
<html>
<head>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Michroma&display=swap" rel="stylesheet">
    <style>
        body { background: #051629; font-family: Michroma; padding: 30px; }
        .top-bar {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }
        .left-form {
            /* Keep form styling as is */
        }
        .pricing {
            background: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 5px #aaa;
            width: 200px;
            font-size: 14px;
            line-height: 1.5;
            
        }
        
        .file { border-bottom: 2px solid blue; }
        .col { float: left; margin-right: 40px; background: #fff; padding: 20px; border-radius: 5px; box-shadow: 0 0 5px #aaa; }
        .icon { margin-right: 5px; }
        a { text-decoration: none; color: inherit; text-decoration: underline; text-decoration-color: yellow;}
    </style>
</head>



<body>
<button id="toggle-settings" style="
  position: fixed; 
  top: 20px; 
  right: 20px; 
  z-index: 1001;
  color: 
">‚öôÔ∏è Settings</button>
<div id="settings-bar" style="
  position: fixed;
  top: 60px;
  right: 20px;
  background: rgba(255, 255, 255, 0.8); /* transparent */
  border-radius: 5px;
  padding: 20px;
  max-height: 0;
  overflow: hidden;
  box-shadow: 0 4px 10px rgba(0,0,0,0.3);
  transition: max-height 0.5s ease, padding 0.5s ease;
  z-index: 1000;
">
  <h3>Settings</h3>
  <label>Page Background: <input type="color" id="pageBgColor"></label><br><br>
  <label>Text Color: <input type="color" id="textColor"></label><br><br>
  <label>Section Background: <input type="color" id="sectionBgColor"></label>
</div>




    <h1>Local Folder Analyzer</h1>
    <div class="top-bar">
        <div class="left-form">
            <form method="GET" action="/local">
                Base Path: <input name="base" value="{{ base or '' }}" size="50"><br><br>
                Folder to Analyze: <input name="folder" value="{{ folder or '' }}" size="50"><br><br>
                Video Count Price: <input name="video_price" value="{{ video_price or 0 }}" size="10"> $ per video<br><br>
                Minute Price: <input name="minute_price" value="{{ minute_price or 0 }}" size="10"> $ per minute<br><br>
                <button type="submit">Analyze</button>
            </form>
        </div>

        <div class="pricing">
            <h3>Pricing</h3>
            <p>Total videos: {{ total_videos }}</p>
            <p>Total minutes: {{ total_minutes }}</p>
            <p>Video Count Total: {{ (total_videos * video_price) | round(2) }} $</p>
            <p>Minute Count Total: {{ (total_minutes * minute_price) | round(2) }} $</p>
        </div>
    </div>

    {% if error %}
    <p style="color:red;">{{ error }}</p>
    {% endif %}

    {% if columns %}
    <div style="overflow:auto; margin-top:30px;">
        {% for col in columns %}
        <div class="col">
            {% for item in col %}
                {% if item.type == 'folder' %}
                    <div>
                        <span class="icon">üìÅ</span>
                        
                        <a href="/local?base={{ base }}&folder={{ item.rel_path }}&video_price={{ video_price }}&minute_price={{ minute_price }}">
                            <span class="folder">{{ item.name }}</span>
                        </a><br>
                        {{ item.count }} items ‚Äî {{ item.modified }}
                    </div><br>
                {% else %}
                    <div><span class="icon">üìº</span><span class="file">{{ item.name }}</span><br>
                    {{ item.duration }} ‚Äî {{ item.modified }}</div><br>
                {% endif %}
            {% endfor %}
        </div>
        {% endfor %}
    </div>
    {% endif %}

<script>
  window.addEventListener('DOMContentLoaded', () => {
    const toggleBtn = document.getElementById('toggle-settings');
    const settingsBar = document.getElementById('settings-bar');

    toggleBtn.addEventListener('click', () => {
      if (settingsBar.style.maxHeight === '0px' || !settingsBar.style.maxHeight) {
        settingsBar.style.maxHeight = '500px'; // adjust as needed
        settingsBar.style.padding = '20px';
      } else {
        settingsBar.style.maxHeight = '0';
        settingsBar.style.padding = '0 20px';
      }
    });

    const pageBgInput = document.getElementById('pageBgColor');
    const textColorInput = document.getElementById('textColor');
    const sectionBgInput = document.getElementById('sectionBgColor');

    function loadColors() {
      const savedPageBg = localStorage.getItem('pageBgColor') || '#051629';
      const savedTextColor = localStorage.getItem('textColor') || '#ffffff';
      const savedSectionBg = localStorage.getItem('sectionBgColor') || '#ffffff';

      pageBgInput.value = savedPageBg;
      textColorInput.value = savedTextColor;
      sectionBgInput.value = savedSectionBg;

      updateColors();
    }

    function saveColors() {
      localStorage.setItem('pageBgColor', pageBgInput.value);
      localStorage.setItem('textColor', textColorInput.value);
      localStorage.setItem('sectionBgColor', sectionBgInput.value);
    }

    function updateColors() {
      document.body.style.backgroundColor = pageBgInput.value;
      document.body.style.color = textColorInput.value;

      document.querySelectorAll('.col, .pricing, #settings-bar').forEach(el => {
        el.style.backgroundColor = sectionBgInput.value + 'CC'; // 80% opacity
        el.style.color = textColorInput.value;
      });

      saveColors();
    }

    pageBgInput.addEventListener('input', updateColors);
    textColorInput.addEventListener('input', updateColors);
    sectionBgInput.addEventListener('input', updateColors);

    loadColors();
  });
</script>

</body>
</html>
